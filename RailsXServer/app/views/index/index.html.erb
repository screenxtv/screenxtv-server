<%= javascript_include_tag "top" %>
<%= stylesheet_link_tag "application" %>
<script>
terminalList=[<%= @screens.map(&:to_json).join(",").html_safe %>];


$(function(){
	var first=terminalList[0];
	if(first&&first.casting){
		$("#demoframe").attr("src","/embed/"+first.url);
    $("#demohref").attr('href','/'+first.url)
	}
	var main=$('#terminal-list');
	var tiles=[];
	for(var i=0;i<terminalList.length;i++){
		var data=terminalList[i];
		var vt100=data.vt100;
		var div=document.createElement('div');
		div.className='terminal-thumbnail';
		main.append(div);
		console.log(vt100)
		var terminal=new Terminal(div,vt100.W,vt100.H,Terminal.defaultColorMap[data.color]);
		terminal.vt100=new VT100(vt100);
		terminal.updateView();
		div.removeChild(div.firstChild);
		var title=document.createElement('a');
		console.log(data)
		title.href='/'+data.url;
		title.className='title'
		title.innerHTML="<div></div>"
		title.firstChild.textContent=data.title;
		div.appendChild(title);
		if(!data.casting)div.style.opacity=0.5;
		tiles.push(div);
	}
	while(tiles.length<6){
		var div=document.createElement("div");
		div.className='terminal-thumbnail-dummy';
		main.append(div);
		tiles.push(div);
	}
	console.log(tiles[0])
  main.append("<div style='clear:both'/>");
});

function textselect(e){
  e.select(0,e.value.length);			     
}
</script>
<style>
  .codefor{
    font-size:20px;
    font-weight:bold;
    position:relative;
    font-family:Sans-Serif;
  }
  .codefor:after{
    content:':';
    position:absolute;
    right:10px;
  }
  .codeto{
    font-family:Courier;
    font-size:22px;
    border:2px solid gray;
    background:#666;
    color:white;
    border-radius:4px;
    overflow:hidden;
    text-shadow:0 0 4px black;
    margin-bottom:6px;
  }
  .codeto:before{
    content:'$ ';
  }
  .more{
    font-family:Sans-Serif;
    font-size:22px;
    padding:0 2px;
    overflow:hidden;
    font-family:Courier;
  }
</style>
<center>
<div class='contents'>
  <div class='contents_top'>
    <div class="top_info">
      <center><img src='/assets/logo_large.png' width='256'></center>
      <div class='description' style='font-size:18px;'>
        The best way to broadcast your terminal to the world.<br>
        Show your live coding for a presentation, hackathon, or pair code reading.<br>
      </div>
      <div class='howto'>
<div class='codefor' style='float:left;width:150px;'>Install</div>
<div class='codeto'>gem install screenxtv</div>
<div class='codefor' style='float:left;width:150px;'>Broadcast</div>
<div class='codeto'>screenxtv [--private]</div>
<div class='codefor' style='float:left;width:150px;'>For details</div>
<div class='more'>See <a href="http://screenx.tv/doc/howto">this document</a>.</div>
<!--	To broadcast, install <a href='/doc/howto' style='text-decoration:underline;font-weight:bold;border-radius:2px;border:1px solid silver;background:#ddd;color:#800;margin:1px;padding:1px 2px;'>this broadcasting tool</a> or type this command:<br>
        <input class='code' onclick='textselect(this)' style='display:block;width:500px;' value="curl -s -L https://raw.github.com/screenxtv/screenxtv-sandbox/master/run.sh | bash">-->
      </div>
    </div>
    <div class='top_demo'>
      <iframe id='demoframe'></iframe>
      <a id='demohref'></a>
    </div>
  </div>
  <div id='terminal-list'></div>
</div>
</center>
