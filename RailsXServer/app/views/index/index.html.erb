<%= javascript_include_tag "top" %>
<%= stylesheet_link_tag "application" %>
<script>
terminalList=[<%= @screens.map(&:to_json).join(",").html_safe %>];


$(function(){
	var first=terminalList[0];
	if(first&&first.casting){
		$("#demoframe").attr("src","/embed/"+first.url);
    $("#demohref").attr('href','/'+first.url)
	}
	var main=$('#terminal-list');
	var tiles=[];
	for(var i=0;i<terminalList.length;i++){
		var data=terminalList[i];
		var vt100=data.vt100;
		var div=document.createElement('div');
		div.className='terminal-thumbnail';
		main.append(div);
		console.log(vt100)
		var terminal=new Terminal(div,vt100.W,vt100.H,Terminal.defaultColorMap[data.color]);
		terminal.vt100=new VT100(vt100);
		terminal.updateView();
		div.removeChild(div.firstChild);
		var title=document.createElement('a');
		console.log(data)
		title.href='/'+data.url;
		title.className='title'
		title.innerHTML="<div></div>"
		title.firstChild.textContent=data.title;
		div.appendChild(title);
		if(!data.casting)div.style.opacity=0.5;
		tiles.push(div);
	}
	while(tiles.length<6){
		var div=document.createElement("div");
		div.className='terminal-thumbnail-dummy';
		main.append(div);
		tiles.push(div);
	}
	console.log(tiles[0])
  main.append("<div style='clear:both'/>");
});

function textselect(e){
  e.select(0,e.value.length);			     
}
</script>
<center>
<div class='contents'>
  <div class='contents_top'>
    <div class="top_info">
      <center><img src='/assets/logo_large.png' width=300></center>
      <div class='description'>
        The best way to broadcast your terminal to the world.<br>
        Show your live coding for a presentation, hackathon, or pair code reading.<br>
      </div>
      <div class='howto'>
	To broadcast, install <a href='/doc/howto' style='text-decoration:underline;font-weight:bold;border-radius:2px;border:1px solid silver;background:#ddd;color:#800;margin:1px;padding:1px 2px;'>this broadcasting tool</a> or type this command:<br>
        <input class='code' onclick='textselect(this)' style='display:block;width:500px;' value="curl -s -L https://raw.github.com/yasulab/screenxtv-sandbox/master/run.sh | bash">
      </div>
    </div>
    <div class='top_demo'>
      <iframe id='demoframe'></iframe>
      <a id='demohref'></a>
    </div>
  </div>
  <div id='terminal-list'></div>
</div>
</center>
